# 1, What are the details of all cars purchased in the year 2022?
SELECT SALES.CAR_ID, COUNT(SALES.CAR_ID) AS TOTAL_NUMBER_OF_CARS,
 MAKE, TYPE, STYLE, COST_$, SUM(COST_$) AS TOTAL_$
FROM SALES
JOIN CARS 
ON CARS.CAR_ID = SALES.CAR_ID
WHERE YEAR(PURCHASE_DATE) = '2022'
GROUP BY SALES.CAR_ID;

# 2, What is the total number of cars sold by each salesperson?
SELECT SP.SALESMAN_ID, NAME, COUNT(CAR_ID) NUMBER_OF_CARS_SOLD
FROM SALES 
JOIN SALESPERSONS SP
ON SP.SALESMAN_ID = SALES.SALESMAN_ID
GROUP BY SP.SALESMAN_ID
ORDER BY SP.SALESMAN_ID;

# 3, What is the total revenue generated by each salesperson?
SELECT SALES.SALESMAN_ID,NAME, SUM(COST_$) AS REVENUE
FROM SALES 
JOIN CARS ON SALES.CAR_ID = SALES.CAR_ID
JOIN SALESPERSONS ON SALESPERSONS.SALESMAN_ID = SALES.SALESMAN_ID
GROUP BY SALES.SALESMAN_ID, NAME
ORDER BY SALES.SALESMAN_ID;

# 4, What are the details of the cars sold by each salesperson?
SELECT SALES.SALESMAN_ID, NAME, SALES.CAR_ID, COUNT(SALES.CAR_ID) AS NUMBER_OF_CARS,
 MAKE, TYPE, STYLE, SUM(COST_$) AS PRICE
FROM SALES 
JOIN CARS ON SALES.CAR_ID = CARS.CAR_ID
JOIN SALESPERSONS ON SALESPERSONS.SALESMAN_ID = SALES.SALESMAN_ID
GROUP BY SALES.SALESMAN_ID, SALES.CAR_ID;

# 5, What is the total revenue generated by each car type?
SELECT S.CAR_ID, TYPE, SUM(COST_$) AS REVENUE
FROM SALES S
JOIN CARS ON S.CAR_ID = CARS.CAR_ID
GROUP BY S.CAR_ID
ORDER BY S.CAR_ID;

# 6, What are the details of the cars sold in the year 2021 by salesperson 'Emily Wong'?
SELECT SALES.SALESMAN_ID, NAME, SALES.CAR_ID, MAKE, TYPE, STYLE, COST_$
FROM SALES 
JOIN CARS ON SALES.CAR_ID = CARS.CAR_ID
JOIN SALESPERSONS ON SALESPERSONS.SALESMAN_ID = SALES.SALESMAN_ID
WHERE NAME = 'Emily Wong' AND YEAR(PURCHASE_DATE) = '2021';

# 7, What is the total revenue generated by the sales of hatchback cars?
SELECT STYLE, SUM(COST_$) AS REVENUE
FROM SALES S
JOIN CARS ON CARS.CAR_ID = S.CAR_ID
WHERE STYLE = 'Hatchback'
GROUP BY STYLE;

# 8, What is the total revenue generated by the sales of SUV cars in the year 2022?
SELECT STYLE, SUM(COST_$) AS REVENUE
FROM SALES S
JOIN CARS ON CARS.CAR_ID = S.CAR_ID
WHERE STYLE = 'SUV' AND YEAR(PURCHASE_DATE) = '2022'
GROUP BY STYLE;

# 9, What is the name and city of the salesperson who sold the most number of cars in the year 2023?
SELECT SALES.SALESMAN_ID, NAME, CITY, COUNT(SALES.CAR_ID) NUMBER_OF_CARS
FROM SALES
JOIN SALESPERSONS SP ON SP.SALESMAN_ID = SALES.SALESMAN_ID
WHERE YEAR(PURCHASE_DATE) = '2023'
GROUP BY SALES.SALESMAN_ID
ORDER BY COUNT(SALES.CAR_ID) DESC
LIMIT 1;

# 10, What is the name and age of the salesperson who generated the highest revenue in the year 2022?
SELECT SALES.SALESMAN_ID, NAME, AGE, SUM(COST_$) AS REVENUE
FROM SALES
JOIN SALESPERSONS SP ON SP.SALESMAN_ID = SALES.SALESMAN_ID
JOIN CARS ON CARS.CAR_ID = SALES.CAR_ID
WHERE YEAR(PURCHASE_DATE) = '2022'
GROUP BY SALES.SALESMAN_ID
ORDER BY SUM(COST_$) DESC
LIMIT 1;
